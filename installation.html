
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Installation Â· SNiPER Documentation</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    


    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="Tools.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="motivation.html">
            
                <a href="motivation.html">
            
                    
                    Motivation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Architecture/0.Architecture.html">
            
                <a href="Architecture/0.Architecture.html">
            
                    
                    Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="Architecture/1.Concepts.html">
            
                <a href="Architecture/1.Concepts.html">
            
                    
                    General Concepts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="Architecture/2.Interfaces.html">
            
                <a href="Architecture/2.Interfaces.html">
            
                    
                    Interfaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="Architecture/3.ExeSeq.html">
            
                <a href="Architecture/3.ExeSeq.html">
            
                    
                    Execution Sequence
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Algorithms/0.Algorithms.html">
            
                <a href="Algorithms/0.Algorithms.html">
            
                    
                    Algorithms
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="Algorithms/1.CppCode.html">
            
                <a href="Algorithms/1.CppCode.html">
            
                    
                    C++ Implementation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="Algorithms/2.Python.html">
            
                <a href="Algorithms/2.Python.html">
            
                    
                    Python Configuration and Execution
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="Services/0.Services.html">
            
                <a href="Services/0.Services.html">
            
                    
                    Services
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="Services/1.CppCode.html">
            
                <a href="Services/1.CppCode.html">
            
                    
                    C++ Implementation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="Services/2.Invoke.html">
            
                <a href="Services/2.Invoke.html">
            
                    
                    Invoke a Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="Services/3.Python.html">
            
                <a href="Services/3.Python.html">
            
                    
                    Python Configuration and Execution
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="Task/0.Task.html">
            
                <a href="Task/0.Task.html">
            
                    
                    Tasks
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="Task/1.StateMachine.html">
            
                <a href="Task/1.StateMachine.html">
            
                    
                    State Machine
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="DataManagement.html">
            
                <a href="DataManagement.html">
            
                    
                    Data Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="Tools.html">
            
                <a href="Tools.html">
            
                    
                    Tools
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.9" data-path="installation.html">
            
                <a href="installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Installation</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="installation">Installation</h1>
<p>In this part, we will introduce how to install SNiPER.</p>
<p>The source code of SNiPER is open-source. The public SNiPER repository can be found in <a href="http://gitlab.ihep.ac.cn/zoujh/sniper" target="_blank">IHEP gitlab</a>. For several experiments using SNiPER, they have their own requirements, so the source code is private and installation is done by their own tools.</p>
<h2 id="general-installation-of-sniper">General installation of SNiPER</h2>
<p>To build SNiPER, we need several libraries and tools installed:</p>
<ul>
<li>CMT, configuration management tools</li>
<li>git, get the source code of SNiPER</li>
<li>Python, python-devel</li>
<li>Boost, boost.python</li>
<li>Intel TBB, for parallel computing</li>
</ul>
<p>Note: in following example, Scientific Linux 6.9 with GCC 4.4.7 is used.<br>To enable c++11 features, we use <a href="http://linux.web.cern.ch/linux/devtoolset/" target="_blank">devtoolset</a> so that gcc 4.8 is available for us.</p>
<h3 id="external-libraries">External Libraries</h3>
<p>It&apos;s not necessary to use root permission to install these libraries.<br>We will use a normal user to install them.</p>
<p>Create a directory for the projects:</p>
<pre><code>$ mkdir /DEV/sniper-general
</code></pre><p>Create a directory called <code>ExternalLibs</code>, which will be used to install the external libraries:</p>
<pre><code>$ mkdir /DEV/sniper-general/ExternalLibs
</code></pre><p>Create <code>Build</code> under it, to save installation tarballs and caches.</p>
<pre><code>$ mkdir /DEV/sniper-general/ExternalLibs/Build
</code></pre><h4 id="python">Python</h4>
<p>Let&apos;s install python first:</p>
<pre><code>$ cd /DEV/sniper-general/ExternalLibs/Build
$ wget http://www.python.org/ftp/python/2.7.14/Python-2.7.14.tgz
$ tar zxvf Python-2.7.14.tgz 
$ cd Python-2.7.14
$ mkdir -p /DEV/sniper-general/ExternalLibs/Python/2.14
$ ./configure --prefix=/DEV/sniper-general/ExternalLibs/Python/2.14 --enable-shared --enable-unicode=ucs4
$ make -j8
$ make install
</code></pre><p>To make python available for us, we create a setup script <code>bashrc</code>:</p>
<pre><code>$ touch /DEV/sniper-general/ExternalLibs/Python/2.14/bashrc
$ # Please edit this file
$ cat /DEV/sniper-general/ExternalLibs/Python/2.14/bashrc
export PYTHONROOT=/DEV/sniper-general/ExternalLibs/Python/2.14
export PATH=$PYTHONROOT/bin:$PATH
export LD_LIBRARY_PATH=$PYTHONROOT/lib:$LD_LIBRARY_PATH
export PKG_CONFIG_PATH=$PYTHONROOT/lib/pkgconfig:$PKG_CONFIG_PATH
export CPATH=$PYTHONROOT/include:$CPATH
export CMAKE_PREFIX_PATH=$PYTHONROOT:$CMAKE_PREFIX_PATH
export PYTHONPATH=$PYTHONROOT/lib/python2.7/lib-dynload:$PYTHONPATH
</code></pre><p>Then source this bashrc:</p>
<pre><code>$ source /DEV/sniper-general/ExternalLibs/Python/2.14/bashrc
$ which python
/DEV/sniper-general/ExternalLibs/Python/2.14/bin/python
</code></pre><h4 id="boost">Boost</h4>
<p>Now, let&apos;s install boost. Before install boost, make sure you source <code>bashrc</code> of our own python.<br>Then, download and install it:</p>
<pre><code>$ cd /DEV/sniper-general/ExternalLibs/Build
$ wget http://sourceforge.net/projects/boost/files/boost/1.65.1/boost_1_65_1.tar.gz
$ tar zxvf boost_1_65_1.tar.gz 
$ cd boost_1_65_1
$ mkdir -p /DEV/sniper-general/ExternalLibs/Boost/1.65.1
$ ./bootstrap.sh --prefix=/DEV/sniper-general/ExternalLibs/Boost/1.65.1
$ ./b2 install -j8
$ ./b2 install
</code></pre><p>Then create <code>bashrc</code>:</p>
<pre><code>$ touch /DEV/sniper-general/ExternalLibs/Boost/1.65.1/bashrc
$ # Please edit this file
$ cat /DEV/sniper-general/ExternalLibs/Boost/1.65.1/bashrc
export BOOSTROOT=/DEV/sniper-general/ExternalLibs/Boost/1.65.1
export LD_LIBRARY_PATH=$BOOSTROOT/lib:$LD_LIBRARY_PATH
export CPATH=$BOOSTROOT/include:$CPATH
export CMAKE_PREFIX_PATH=$BOOSTROOT:$CMAKE_PREFIX_PATH
</code></pre><p>Source this bashrc:</p>
<pre><code>$ source /DEV/sniper-general/ExternalLibs/Boost/1.65.1/bashrc
</code></pre><h4 id="intel-tbb">Intel TBB</h4>
<p>Intel TBB is also easy to install:</p>
<pre><code>$ cd /DEV/sniper-general/ExternalLibs/Build
$ wget https://github.com/01org/tbb/archive/2018_U2.tar.gz
$ tar zxvf 2018_U2.tar.gz 
$ cd tbb-2018_U2/
$ make
</code></pre><p>A bit different from other libraries, the libraries are created under <code>build</code>:</p>
<pre><code>$ ls build/
linux_intel64_gcc_cc4.4.7_libc2.12_kernel2.6.32_debug
linux_intel64_gcc_cc4.4.7_libc2.12_kernel2.6.32_release
</code></pre><p>We will install both libraries under <code>release</code> and <code>debug</code>:</p>
<pre><code>$ mkdir -p /DEV/sniper-general/ExternalLibs/tbb/2018
$ prefix=/DEV/sniper-general/ExternalLibs/tbb/2018
$ install -d $prefix/include/serial
$ install -d $prefix/include/serial/tbb
$ install -t $prefix/include/serial/tbb include/serial/tbb/*.h
$ install -d $prefix/include/tbb
$ install -t $prefix/include/tbb include/tbb/*.h
$ install -d $prefix/include/tbb/compat
$ install -t $prefix/include/tbb/compat include/tbb/compat/*
$ install -d $prefix/include/tbb/internal
$ install -t $prefix/include/tbb/internal include/tbb/internal/*
$ install -d $prefix/include/tbb/machine
$ install -t $prefix/include/tbb/machine include/tbb/machine/*.h
$ install -d $prefix/lib
$ install -t $prefix/lib build/linux*/*.so*
</code></pre><p>Then create <code>bashrc</code>:</p>
<pre><code>$ touch /DEV/sniper-general/ExternalLibs/tbb/2018/bashrc
$ # Please edit this file
$ cat /DEV/sniper-general/ExternalLibs/tbb/2018/bashrc
export TBBROOT=/DEV/sniper-general/ExternalLibs/tbb/2018
export LD_LIBRARY_PATH=$TBBROOT/lib:$LD_LIBRARY_PATH
export CPATH=$TBBROOT/include:$CPATH
export CMAKE_PREFIX_PATH=$TBBROOT:$CMAKE_PREFIX_PATH
</code></pre><p>Source it:</p>
<pre><code>$ source /DEV/sniper-general/ExternalLibs/tbb/2018/bashrc
</code></pre><h4 id="cmt">CMT</h4>
<p>Let&apos;s install CMT:</p>
<pre><code>$ cd /DEV/sniper-general/ExternalLibs/Build
$ wget http://www.cmtsite.net/v1r26/CMTv1r26.tar.gz
$ tar -C /DEV/sniper-general/ExternalLibs -zxvf CMTv1r26.tar.gz
$ cd /DEV/sniper-general/ExternalLibs/CMT/v1r26/mgr/
$ ./INSTALL
$ source setup.sh
$ make
</code></pre><h3 id="sniper">SNiPER</h3>
<p>After these external libraries are installed, we can install sniper now.</p>
<p>Get the source code:</p>
<pre><code>$ cd DEV/sniper-general
$ git clone http://gitlab.ihep.ac.cn/zoujh/sniper.git
</code></pre><p>In this version, under sniper there are two directories. One is source code. Another is external interface.<br>We need to setup an environment variable called <code>$CMTPROJECTPATH</code> to let CMT compile SNiPER.</p>
<pre><code>$ cd sniper
$ export CMTPROJECTPATH=/DEV/sniper-general/sniper:$CMTPROJECTPATH
</code></pre><p>Setup external interfaces first. To let CMT know our installed libraries, we need to modify several files:</p>
<pre><code>$ # edit Externals/Boost/cmt/requirements
$ cat Externals/Boost/cmt/requirements
package Boost

use Python v* Externals

macro_append Boost_linkopts &quot; -L$BOOSTROOT/lib -lboost_python &quot;
include_path none
</code></pre><p>Here, <code>-L$BOOSTROOT/lib</code> tells linker where to find <code>boost_python</code>.</p>
<p>Then, we could setup external interface:</p>
<pre><code>$ cd ExternalInterface/EIRelease/cmt
$ cmt br cmt config
$ source setup.sh
</code></pre><p>Finally, we could build SNiPER:</p>
<pre><code>$ cd /DEV/sniper-general/sniper/sniper/SniperRelease/cmt
$ cmt br cmt config
$ source setup.sh
$ cmt br cmt make
</code></pre><h2 id="experiments-specific-sniper">Experiments-specific SNiPER</h2>
<ul>
<li>For JUNO experiment, there is a tool called <code>junoenv</code>.</li>
<li>For nEXO experiment, there is a tool called <code>nexoenv</code>.</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Tools.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Tools">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Installation","level":"1.9","depth":1,"previous":{"title":"Tools","level":"1.8","depth":1,"path":"Tools.md","ref":"Tools.md","articles":[]},"dir":"ltr"},"config":{"plugins":["flow","sequence","mermaid-gb3"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"sequence":{"theme":"simple"},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"flow":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"mermaid-gb3":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"SNiPER Documentation","gitbook":"3.x.x"},"file":{"path":"installation.md","mtime":"2017-12-14T02:16:44.583Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-12-14T02:18:09.903Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-mermaid-gb3/book/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    <script src="gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.min.js"></script>

    </body>
</html>

